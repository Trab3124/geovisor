<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Geovisor de Avance Catastral</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<!-- Buscador tipo Google Maps (Geocoder OSM) -->
<link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
<script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>

<style>
body { margin:0; font-family: Arial, sans-serif; }

header {
  background:#1e40af;
  color:white;
  padding:14px 20px;
  font-size:20px;
  font-weight:bold;
}

#map { height: calc(100vh - 65px); }
</style>
</head>
<body>

<header>
  Geovisor de Avance Catastral
</header>

<div id="map"></div>

<script>

// Crear mapa
var map = L.map('map').setView([-11.99, -77.05], 14); // Ajusta si quieres

// Base OpenStreetMap
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: 'Â© OpenStreetMap contributors'
}).addTo(map);

// =============================
// ðŸ”Ž BUSCADOR TIPO GOOGLE MAPS
// =============================

L.Control.geocoder({
    defaultMarkGeocode: true,
    placeholder: "Buscar direcciÃ³n...",
    errorMessage: "No se encontrÃ³ la direcciÃ³n"
}).addTo(map);


// =============================
// CARGAR CAPAS
// =============================

// Manzana
fetch('data/manzana.geojson')
.then(res => res.json())
.then(data => {

  L.geoJSON(data, {
    style: {
      color:"#1d4ed8",
      weight:2,
      fill:false
    },
    onEachFeature: function(feature, layer){
      layer.bindPopup(
        "<b>Sector:</b> "+feature.properties.cod_sector+
        "<br><b>Manzana:</b> "+feature.properties.cod_manzana
      );
    }
  }).addTo(map);

});

// Lotes
fetch('data/lotes.geojson')
.then(res => res.json())
.then(data => {

  L.geoJSON(data, {
    style: {
      color:"#16a34a",
      weight:1,
      fillOpacity:0.4
    },
    onEachFeature: function(feature, layer){
      layer.bindPopup(
        "<b>Lote:</b> "+feature.properties.cod_lote+
        "<br><b>Manzana:</b> "+feature.properties.cod_manzana
      );
    }
  }).addTo(map);

});

</script>
</body>
</html>

